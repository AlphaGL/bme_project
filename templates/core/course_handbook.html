{% extends 'base.html' %}

{% block title %}Course Handbook - BME FUTO{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="py-5 bg-primary text-white">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="display-5 fw-bold mb-3">
                    <i class="fas fa-book-open me-3"></i>Course Handbook
                </h1>
                <p class="lead mb-0">
                    Complete listing of courses for all levels and semesters in Biomedical Engineering
                </p>
            </div>
            <div class="col-lg-4 text-lg-end">
                <i class="fas fa-graduation-cap" style="font-size: 100px; opacity: 0.3;"></i>
            </div>
        </div>
    </div>
</section>

<!-- Filter Section -->
<section class="py-4 bg-light">
    <div class="container">
        <form method="GET" class="row g-3 align-items-end">
            <div class="col-md-5">
                <label class="form-label fw-bold">
                    <i class="fas fa-layer-group me-2"></i>Select Level
                </label>
                <select name="level" class="form-select form-select-lg" onchange="this.form.submit()">
                    <option value="100" {% if selected_level == '100' %}selected{% endif %}>100 Level</option>
                    <option value="200" {% if selected_level == '200' %}selected{% endif %}>200 Level</option>
                    <option value="300" {% if selected_level == '300' %}selected{% endif %}>300 Level</option>
                    <option value="400" {% if selected_level == '400' %}selected{% endif %}>400 Level</option>
                    <option value="500" {% if selected_level == '500' %}selected{% endif %}>500 Level</option>
                </select>
            </div>
            <div class="col-md-5">
                <label class="form-label fw-bold">
                    <i class="fas fa-calendar-alt me-2"></i>Select Semester
                </label>
                <select name="semester" class="form-select form-select-lg" onchange="this.form.submit()">
                    <option value="First" {% if selected_semester == 'First' %}selected{% endif %}>First Semester</option>
                    <option value="Second" {% if selected_semester == 'Second' %}selected{% endif %}>Second Semester</option>
                </select>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary btn-lg w-100">
                    <i class="fas fa-filter me-2"></i>Filter
                </button>
            </div>
        </form>
    </div>
</section>

<!-- Courses Display -->
<section class="py-5">
    <div class="container">
        {% if courses %}
        <!-- Header -->
        <div class="row mb-4">
            <div class="col">
                <div class="card border-0 shadow-sm bg-light">
                    <div class="card-body p-4">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h3 class="fw-bold mb-2">
                                    {{ selected_level }} Level - {{ selected_semester }} Semester
                                </h3>
                                <p class="text-muted mb-0">
                                    <i class="fas fa-book me-2"></i>{{ courses|length }} Course{{ courses|length|pluralize }}
                                    <span class="ms-3">
                                        <i class="fas fa-credit-card me-2"></i>{{ total_credits }} Total Credit Unit{{ total_credits|pluralize }}
                                    </span>
                                </p>
                            </div>
                            <div class="col-md-4 text-md-end">
                                <button onclick="window.print()" class="btn btn-outline-primary">
                                    <i class="fas fa-print me-2"></i>Print Handbook
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Courses Table -->
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead class="table-primary">
                            <tr>
                                <th width="15%">Course Code</th>
                                <th width="45%">Course Title</th>
                                <th width="15%" class="text-center">Credit Units</th>
                                <th width="15%" class="text-center">Type</th>
                                <th width="10%" class="text-center">Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for course in courses %}
                            <tr>
                                <td>
                                    <strong class="text-primary">{{ course.course_code }}</strong>
                                </td>
                                <td>{{ course.course_title }}</td>
                                <td class="text-center">
                                    <span class="badge bg-info">{{ course.credit_unit }}</span>
                                </td>
                                <td class="text-center">
                                    <span class="badge 
                                        {% if course.course_type == 'Core' %}bg-danger
                                        {% elif course.course_type == 'Required' %}bg-warning
                                        {% else %}bg-success{% endif %}">
                                        {{ course.course_type }}
                                    </span>
                                </td>
                                <td class="text-center">
                                    {% if course.description %}
                                    <button class="btn btn-sm btn-outline-primary" 
                                            data-bs-toggle="modal" 
                                            data-bs-target="#courseModal{{ course.id }}">
                                        <i class="fas fa-info-circle"></i>
                                    </button>
                                    {% else %}
                                    <span class="text-muted small">-</span>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                        <tfoot class="table-light">
                            <tr>
                                <td colspan="2"><strong>TOTAL</strong></td>
                                <td class="text-center"><strong class="text-primary fs-5">{{ total_credits }}</strong></td>
                                <td colspan="2"></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>

        <!-- Course Type Legend -->
        <div class="row mt-4">
            <div class="col">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <h6 class="fw-bold mb-3">
                            <i class="fas fa-info-circle me-2"></i>Course Type Legend
                        </h6>
                        <div class="row">
                            <div class="col-md-4">
                                <span class="badge bg-danger me-2">Core</span>
                                <span class="text-muted small">Compulsory core courses</span>
                            </div>
                            <div class="col-md-4">
                                <span class="badge bg-warning me-2">Required</span>
                                <span class="text-muted small">Required departmental courses</span>
                            </div>
                            <div class="col-md-4">
                                <span class="badge bg-success me-2">Elective</span>
                                <span class="text-muted small">Elective courses</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Course Description Modals -->
        {% for course in courses %}
        {% if course.description %}
        <div class="modal fade" id="courseModal{{ course.id }}" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header bg-primary text-white">
                        <h5 class="modal-title">
                            <i class="fas fa-book me-2"></i>{{ course.course_code }}
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <h6 class="fw-bold mb-3">{{ course.course_title }}</h6>
                        <p class="mb-3">{{ course.description }}</p>
                        <div class="row">
                            <div class="col-6">
                                <p class="mb-0 small text-muted">Credit Units:</p>
                                <p class="mb-0 fw-bold">{{ course.credit_unit }}</p>
                            </div>
                            <div class="col-6">
                                <p class="mb-0 small text-muted">Course Type:</p>
                                <p class="mb-0 fw-bold">{{ course.course_type }}</p>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
        {% endfor %}

        {% else %}
        <!-- No Courses -->
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <div class="card border-0 shadow-sm text-center p-5">
                    <i class="fas fa-book-open fa-5x text-muted mb-4"></i>
                    <h4 class="fw-bold mb-3">No Courses Available</h4>
                    <p class="text-muted mb-4">
                        There are currently no courses listed for {{ selected_level }} Level {{ selected_semester }} Semester.
                    </p>
                    <p class="text-muted small">
                        Please check back later or contact the department for more information.
                    </p>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</section>

<!-- Additional Information -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row g-4">
            <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body p-4">
                        <i class="fas fa-graduation-cap fa-3x text-primary mb-3"></i>
                        <h5 class="fw-bold mb-3">About BME Programme</h5>
                        <p class="text-muted mb-0">
                            The Biomedical Engineering programme combines engineering principles with medical and biological sciences to design and create equipment, devices, computer systems, and software used in healthcare.
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body p-4">
                        <i class="fas fa-info-circle fa-3x text-success mb-3"></i>
                        <h5 class="fw-bold mb-3">Need Help?</h5>
                        <p class="text-muted mb-3">
                            For more information about course registration, prerequisites, or academic guidance:
                        </p>
                        <a href="{% url 'staff_list' %}" class="btn btn-outline-success">
                            <i class="fas fa-users me-2"></i>Contact Academic Staff
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
@media print {
    .no-print, nav, footer, .btn, .modal {
        display: none !important;
    }
    
    body {
        background: white;
    }
    
    .card {
        box-shadow: none !important;
        border: 1px solid #dee2e6 !important;
    }
}
</style>
{% endblock %}